### 第三章 常用命令
<br>

#### 数值操作：`math`
+ 命令构成：
  ```cmake
  math(EXPR <var> "<str>" [OUTPUT_FORMAT <格式选项>])
  ```
  + 作用：计算`<str>`中的数学表达式结果，并将结果放到`<var>`内
  + 结果格式可通过可选参数`<格式选项>`指定
    + `HEXADECIMAL`：十六进制
    + `DECIMAL`：十进制
  + 运算符与 C 语言相同
  + 数值与计算结果都必须是一个64位有符号整数可表示的
<br>

#### 字符串操作：`string`
##### 搜索与替换
+ 搜索字符串
  ```cmake
  string(FIND <str> <substr> <var> [REVERSE])
  ```
  + `REVERSE`：指定自后向前搜索
  + 当查找内容不存在时，`<var>`将为`-1`
+ 替换字符串
  ```cmake
  string(REPLACE <substr><rep_str>
    <var>
  <str>[<str>...])
  ```
<br>

##### 正则匹配和替换
+ 正则表达式语法：
  ![](https://res.weread.qq.com/wrepub/CB_3300091899_5ZcAMEGSi5q801H9ec29.jpg)
  + 例子：匹配 `a+b`：
    ```cmake
    set(regex [[\(a\+b\)]])
    set(regex "\\(a\\+b\\)")
    ```
    + 第一种方法不转义时表现为`\(a\+b\)`，之后转义为`(a+b)`
    + 第二种方法因为是引号变量，需要先转义`\`，因此需要替代`\`为`\`
+ 单次正则匹配：
  ```cmake
  string(
    REGEX MATCH <正则表达式>
    <var>
    <str>[<str>...]
  )
  ```
+ 全部正则匹配：
  ```cmake
  string(
    REGEX MATCHALL <正则表达式>
    <var>
    <str> [<str>...]
  )
  ```
+ 正则替换
  ```cmake
  string(
    REGEX REPLACE <正则表达式>
    <替换表达式> <var>
    <str> [<str>...]
  )
  ```
  + 在`<替换表达式>`中，可以通过`\1~\9`分别引用第1个~第9个子表达式的匹配结果
    + 而`\0`表示匹配到完整字符串
+ 捕获组变量
  + 捕获组（`capture group`）即正则表达式中子表达式匹配的结果
  + 捕获组可以在正则替换表达式中通过反斜杠语法访问
  + 相关的预定义变量如下：
    + `CMAKE_MATCH_COUNT`代表捕获组的数量
    + `CMAKE_MATCH_<n>`代表第 n 个捕获组的匹配内容，当n为 0 时，值为正则匹配的完整结果而非子表达式的匹配结果
<br>

##### 取字符串长度
+ 代码：
  ```cmake
  string(LENGTH <str> <var>)
  ```
<br>

##### 字符串变换
+ 追加字符串：
  ```cmake
  string(APPEND <var> [<str>...])
  ```
+ 前插字符串：
  ```cmake
  string(CONCAT <var> [<str>...])
  ```
+ 分隔符连接：该命令将全部`<str>`以指定的分隔符分隔并连接，并存入`var`
  ```cmake
  string(JOIN <分隔符> <var> <str> [<str>...])
  ```
+ 大小写转换：
  ```cmake
  string(TOLOWER <str> <var>)
  string(WOUPPER <str> <var>)
  ```
+ 重复字符串：将`<str>`重复指定的`<重复次数>`
  ```cmake
  string(REPEAT <str> <重复次数> <var>)
  ```
+ 取子字符串：
  ```cmake
  string(SUBSTRING <str> <begin> <length> <var>)
  ```
  + 当`<begin> + <length> > len(<str>)`或者`<length>=-1`时，该命令会一直截取到`<str>`的末尾
+ 删除首尾空白符
  ```cmake
  string(STRIP <str> <var>)
  ```
+ 删除生成器表达式：删除`<str>`内的生成器表达式
  ```cmake
  string(GENEX_STRIP <str> <res>)
  ```
  + 生成器表达式是之后`CMake`会涉及的概念
<br>

##### 比较字符串
```cmake
string(COMPARE LESS <字符串1> <字符串2> <var>) # 小于
string(COMPARE GREATER <字符串1> <字符串2> <var>) # 大于
string(COMPARE EQUAL <字符串1> <字符串2> <var>) # 等于
string(COMPARE NOTEQUAL <字符串1> <字符串2> <var>) # 不等于
string(COMPARE LESS_EQUAL <字符串1> <字符串2> <var>) # 小于或等于
string(COMPARE GREATER_EQUAL <字符串1> <字符串2> <var>) # 大于或等于
```
+ 满足条件，则`<var>`中为 1，否则为 0
<br>

##### 取哈希值
+ `<哈希算法>`计算的加密哈希（`cryptographic hash`，又称加密散列、密码散列等）值
  ```cmake
  string(<哈希算法> <var> <str>)
  ```
  命令支持`MD5(Message-Digest, MD)`、`SHA1~SHA3`
<br>

##### 生成C标识符
